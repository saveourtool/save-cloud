package com.saveourtool.save.filters

import com.saveourtool.save.entities.vulnerability.VulnerabilityLanguage
import com.saveourtool.save.entities.vulnerability.VulnerabilityStatus
import kotlinx.serialization.Serializable

/**
 * @property identifierPrefix
 * @property statuses
 * @property isOwner
 * @property tags
 * @property minCriticality
 * @property maxCriticality
 * @property language
 * @property authorName
 * @property organizationName
 */
@Serializable
data class VulnerabilityFilter(
    val identifierPrefix: String = "",
    val statuses: List<VulnerabilityStatus>? = null,
    val isOwner: Boolean = false,
    val tags: Set<String> = emptySet(),
    val minCriticality: Float = 0.0f,
    val maxCriticality: Float = 10.0f,
    val language: VulnerabilityLanguage? = null,
    val authorName: String? = null,
    val organizationName: String? = null,
) {
    companion object {
        val empty = VulnerabilityFilter()
        val approved = VulnerabilityFilter(statuses = listOf(VulnerabilityStatus.APPROVED, VulnerabilityStatus.AUTO_APPROVED))
        val pendingApprove = VulnerabilityFilter(statuses = listOf(VulnerabilityStatus.CREATED, VulnerabilityStatus.PENDING_REVIEW))
    }
}
